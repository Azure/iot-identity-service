<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1289px" preserveAspectRatio="none" style="width:1458px;height:1289px;" version="1.1" viewBox="0 0 1458 1289" width="1458px" zoomAndPan="magnify"><defs><filter height="300%" id="f1g1cejif7hzz5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="252" x="606" y="17.4023">Data Flow - new architecture</text><!--MD5=[4034dc877b8eccbaf2b7bb77a2a7acd3]
cluster DPS Service--><path d="M1142.6102,643.1107 C1145.2604,636.4997 1150.5224,637.1507 1154.2509,642.017 C1158.0399,637.6132 1161.7868,636.8509 1164.8141,642.7946 C1167.9493,636.9111 1171.4542,637.4816 1175.3979,641.9695 C1178.8841,637.2784 1183.4328,637.2583 1186.4646,642.4769 C1189.0606,637.1524 1194.2765,637.4636 1197.1534,642.1778 C1200.3695,636.11 1204.0732,636.1654 1208.4821,640.9305 C1211.8505,636.2263 1217.0313,636.6576 1219.0979,642.27 C1222.8327,637.3794 1227.073,637.0926 1230.5433,642.5622 C1233.6143,637.6359 1238.8732,638.0842 1241.6338,642.9151 C1249.4942,636.4852 1257.3155,638.562 1259,649.1992 C1260.6031,649.0462 1261.2756,649.7949 1260.9854,651.372 C1266.3816,655.8373 1265.6367,659.6355 1259.8367,662.9943 C1265.0467,666.2606 1264.9542,670.8023 1260.1941,674.3815 C1265.7203,677.4383 1266.5063,680.9809 1261.1579,685.0225 C1266.7708,688.3411 1266.52,693.3043 1260.4777,695.8937 C1265.6834,699.7466 1266.9785,704.3989 1260.7297,708.4812 C1266.4098,711.8217 1266.935,716.9922 1261.6466,721.1278 C1266.8796,724.9785 1266.3265,728.6034 1261.4691,732.2936 C1266.131,741.6137 1263.8216,749.1118 1252,749.1992 C1253.401,748.4382 1254.2691,749.4732 1254.1729,750.7757 C1250.5511,755.5458 1246.7949,756.4222 1243.1977,750.7499 C1240.917,758.276 1235.6429,759.409 1230.6531,753.2296 C1226.9482,758.5358 1223.0645,757.8777 1219.523,753.0502 C1217.3185,757.3099 1212.6448,757.9295 1209.7998,753.7918 C1207.5939,759.556 1203.1062,761.1669 1198.8385,755.8272 C1194.3,761.3235 1188.3801,759.606 1186.2947,753.2344 C1183.6081,757.768 1178.2963,759.0726 1175.5835,753.2616 C1172.2047,758.1249 1168.3549,757.7418 1165.1464,753.0752 C1161.6447,757.3926 1157.0029,757.0919 1154.739,751.7426 C1142.8194,759.0522 1136.8403,755.7372 1135,742.1992 C1135.7946,741.8681 1136.5236,742.3612 1136.4788,743.2319 C1130.9605,740.5674 1128.5678,734.6297 1135.1229,730.6627 C1128.463,728.3946 1127.4609,723.611 1132.9028,719.0326 C1128.382,716.8491 1127.7389,712.7542 1131.1839,709.1809 C1125.6509,705.5512 1125.1447,701.1353 1130.6594,697.0287 C1124.2955,692.4856 1124.5812,688.423 1131.1289,684.3584 C1127.3398,680.4861 1127.3173,676.4731 1133.02,674.404 C1127.4912,670.0261 1127.4731,665.1796 1134.2717,662.0507 C1126.7037,651.7041 1129.5684,644.7598 1142,642.1992 C1142.6134,642.2048 1142.8426,642.5389 1142.6102,643.1107 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="1155.5" y="660.7344">DPS Service</text><!--MD5=[9cc3614b0e94473f1fa5351936eadb26]
cluster PKI--><path d="M1070.7603,858.178 C1073.1614,852.3421 1078.519,852.5826 1082.0001,856.9932 C1085.3685,851.1416 1091.0075,850.9373 1094.5952,856.7566 C1097.9352,850.5792 1102.8427,851.4267 1105.9453,856.9862 C1109.0415,851.4718 1113.7505,850.1934 1117.923,855.83 C1121.0769,849.9338 1126.1067,851.1053 1129.3051,855.7822 C1133.1099,850.1006 1138.1737,850.572 1141.1251,856.6406 C1145.2232,851.013 1151.2589,850.1686 1154.6325,857.4016 C1162.4913,852.121 1169.3252,852.9506 1172,863.1992 C1172.2147,863.1337 1172.3132,863.2454 1172.2748,863.4535 C1178.6406,866.3913 1179.9212,870.0879 1174.3316,875.1313 C1181.873,877.6945 1182.2386,881.7818 1177.5537,887.5238 C1183.2668,890.2375 1185.4477,895.6653 1179.1163,899.8998 C1185.2501,902.6715 1184.9231,907.4678 1179.9368,911.0573 C1184.9602,915.7031 1183.2426,919.2818 1177.9523,922.0689 C1183.4267,926.1972 1183.0716,931.5764 1177.2391,935.0852 C1182.0025,939.207 1181.2249,944.2125 1174.9155,945.9707 C1178.8461,956.0722 1176.6228,962.0492 1165,963.1992 C1165.9084,963.5543 1166.2546,964.3236 1165.4284,965.0748 C1162.1999,969.8444 1158.4173,970.3 1155.0487,965.2226 C1150.9682,972.873 1145.854,971.6296 1141.1659,965.8508 C1137.6114,970.4724 1133.8415,970.2262 1130.3826,965.7377 C1126.7206,972.7128 1121.523,972.5812 1117.7258,965.8627 C1113.9627,971.8072 1110.0621,971.6268 1105.4475,966.8367 C1101.3695,970.87 1097.8922,970.8002 1094.7796,965.7081 C1090.5439,971.1065 1084.9123,972.1147 1081.293,965.0416 C1071.8871,971.3281 1063.1213,967.9886 1062,956.1992 C1063.3982,956.0659 1063.8682,956.6894 1063.3465,957.9954 C1056.7449,953.6594 1058.3198,949.1848 1063.6698,945.1497 C1059.2548,942.9061 1057.7471,938.527 1062.3742,935.1159 C1055.7123,932.364 1056.6448,926.1075 1061.4985,922.553 C1056.1845,919.4755 1054.6148,914.1574 1060.6747,910.3142 C1054.7003,905.8069 1056.5896,901.425 1062.1837,898.3806 C1057.2595,895.788 1055.994,891.0892 1061.1955,887.5709 C1054.9091,883.4685 1056.7275,877.5548 1062.9129,875.1812 C1055.2749,866.8451 1057.2211,858.3088 1069,856.1992 C1070.4157,856.1311 1071.0843,856.6986 1070.7603,858.178 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="1105" y="874.7344">PKI</text><!--MD5=[4b6597e5202bb255e27abc7ed2ac90aa]
cluster IoT Hub Service--><path d="M804.0263,55.0735 C806.1158,50.0431 809.8475,48.3691 813.8495,53.1608 C818.3705,47.9976 823.3527,48.8639 826.5044,54.7317 C828.8899,50.3307 833.7671,49.136 836.6895,54.1509 C839.5632,48.9742 843.936,48.215 847.2046,53.7638 C850.342,47.4973 854.6905,47.5589 858.539,53.08 C861.1273,47.4092 866.6339,46.6138 869.777,52.5426 C873.5696,47.4465 877.0582,46.1151 881.4781,51.8659 C885.9826,46.841 890.5777,48.1152 893.5205,53.6473 C896.3823,49.0107 901.0146,48.7303 903.3371,54.1727 C907.0128,48.4806 911.3199,49.1848 914.7565,54.4225 C918.8964,48.9697 922.3994,49.7562 926.3024,54.686 C933.7812,47.0064 941.2465,50.5389 943,60.1992 C944.2092,60.094 944.6673,60.5786 944.3125,61.7756 C951.1173,63.963 950.9645,68.302 946.6336,72.8279 C952.7795,75.4096 952.8854,80.451 947.9531,84.3063 C953.702,87.3641 954.5302,91.3673 949.5715,95.9175 C955.8856,100.219 954.9881,104.1812 949.3277,108.2458 C953.962,111.9404 954.322,116.1528 949.1063,119.6563 C953.0322,124.0849 951.8386,128.6825 945.9819,130.217 C950.6755,133.7786 950.9405,139.5173 944.5574,141.7055 C950.6313,150.6168 947.6773,159.5017 936,160.1992 C937.4097,160.4213 937.5211,161.1124 936.9287,162.2439 C933.9251,167.2993 928.9939,166.3789 926.6643,161.5443 C922.5167,168.1133 918.4877,168.712 913.9673,161.8981 C910.8314,165.9035 907.5171,166.3009 904.4432,161.8286 C901.6609,167.6008 896.7565,167.5979 892.8555,163.0896 C889.5065,167.9885 884.9349,167.449 882.0002,162.627 C877.9759,167.9119 872.9769,167.8005 869.7911,161.7259 C866.6805,166.6663 862.9765,167.8926 858.8487,162.8397 C855.2552,167.8794 850.6154,168.5078 846.7706,163.131 C843.111,167.8931 839.73,166.1105 837.2579,161.8754 C833.2462,166.448 829.6431,167.1717 826.0407,161.4303 C822.4937,168.1157 818.4345,167.8619 813.9442,162.3672 C803.5727,167.1814 797.1578,165.3573 795,153.1992 C795.177,153.0389 795.3146,153.0802 795.3975,153.2981 C791.0541,150.0809 790.7274,146.7968 795.2975,143.4887 C788.7629,140.9491 787.9778,136.8543 792.8815,131.9249 C787.3332,128.9266 786.2296,122.673 792.542,119.3544 C786.5995,115.5582 786.6965,111.8409 792.0422,107.5661 C786.5417,104.3756 787.0075,100.3022 791.5142,96.6287 C786.0931,92.2029 788.3571,86.795 794.1617,84.9039 C789.3409,81.2827 789.4957,76.426 795.2188,73.8096 C788.5275,64.6592 789.2942,55.9675 802,53.1992 C803.3181,52.7966 804.4429,53.6007 804.0263,55.0735 " fill="#FFFFFF" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="113" x="812.5" y="71.7344">IoT Hub Service</text><!--MD5=[7794c020febe37fee2610325f7805d30]
cluster Identity Service--><polygon fill="#FF00FF" filter="url(#f1g1cejif7hzz5)" points="843,816.1992,853,806.1992,1030,806.1992,1030,961.1992,1020,971.1992,843,971.1992,843,816.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1020" x2="1029" y1="816.1992" y2="807.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="843" x2="1020" y1="816.1992" y2="816.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1020" x2="1020" y1="816.1992" y2="971.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="42" x="911.5" y="832.7344">«new»</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="877" y="849.2227">Identity Service</text><!--MD5=[9e5069793647d3bf2dd98c06c7283a6f]
cluster Key Service--><polygon fill="#FF00FF" filter="url(#f1g1cejif7hzz5)" points="662,816.1992,672,806.1992,819,806.1992,819,961.1992,809,971.1992,662,971.1992,662,816.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="809" x2="818" y1="816.1992" y2="807.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="662" x2="809" y1="816.1992" y2="816.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="809" x2="809" y1="816.1992" y2="971.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="42" x="715.5" y="832.7344">«new»</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="696" y="849.2227">Key Service</text><!--MD5=[4e0ace6db1f04dc49a616f890a95ce58]
cluster Certificate Service--><polygon fill="#FF00FF" filter="url(#f1g1cejif7hzz5)" points="985,1030.1992,995,1020.1992,1191,1020.1992,1191,1175.1992,1181,1185.1992,985,1185.1992,985,1030.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1181" x2="1190" y1="1030.1992" y2="1021.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="985" x2="1181" y1="1030.1992" y2="1030.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1181" x2="1181" y1="1030.1992" y2="1185.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="42" x="1063" y="1046.7344">«new»</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="130" x="1019" y="1063.2227">Certificate Service</text><!--MD5=[8ff2ff8eaa8b0e22a01544f4bdf4d05f]
cluster Edge Module Runtime--><polygon fill="#FFFF00" filter="url(#f1g1cejif7hzz5)" points="550,404.1992,560,394.1992,968,394.1992,968,747.1992,958,757.1992,550,757.1992,550,404.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="958" x2="967" y1="404.1992" y2="395.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="550" x2="958" y1="404.1992" y2="404.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="958" x2="958" y1="404.1992" y2="757.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="75" x="717.5" y="420.7344">«modified»</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="676" y="437.2227">Edge Module Runtime</text><!--MD5=[7cbe1a5fc3e046c9a58895a21185779e]
cluster MR Legacy Service--><polygon fill="#FFFF00" filter="url(#f1g1cejif7hzz5)" points="658,479.1992,795,479.1992,802,501.6875,805,501.6875,805,585.1992,658,585.1992,658,479.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="658" x2="802" y1="501.6875" y2="501.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="662" y="494.7344">MR Legacy Service</text><!--MD5=[9b13154502175b34a7dde17b32f1f8a1]
cluster Edge Agent--><polygon fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" points="661,239.1992,671,229.1992,935,229.1992,935,335.1992,925,345.1992,661,345.1992,661,239.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="925" x2="934" y1="239.1992" y2="230.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="661" x2="925" y1="239.1992" y2="239.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="925" x2="925" y1="239.1992" y2="345.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="81" x="753.5" y="255.7344">Edge Agent</text><!--MD5=[7d68aa027216ad083fcdb57666e906fc]
cluster Host-level module--><polygon fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" points="22,848.1992,32,838.1992,496,838.1992,496,961.1992,486,971.1992,22,971.1992,22,848.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="486" x2="495" y1="848.1992" y2="839.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="486" y1="848.1992" y2="848.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="486" x2="486" y1="848.1992" y2="971.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="187" y="864.7344">Host-level module</text><!--MD5=[b606e694e189a5e0bde06dd1b8d0f0e0]
cluster Edge Hub--><polygon fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" points="326,239.1992,336,229.1992,637,229.1992,637,335.1992,627,345.1992,326,345.1992,326,239.1992" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="627" x2="636" y1="239.1992" y2="230.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="326" x2="627" y1="239.1992" y2="239.1992"/><line style="stroke: #000000; stroke-width: 1.5;" x1="627" x2="627" y1="239.1992" y2="345.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="443.5" y="255.7344">Edge Hub</text><!--MD5=[e8cfd881e0c7b95e10a1bb0d559cc9f2]
entity DPS Gateway--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="1143.5" y="688.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1138.5" y="693.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1138.5" y="731.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="1166.5" y="711.7344">«service»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="1153.5" y="728.2227">DPS Gateway</text><!--MD5=[344739cc555d75ba553dad245e8ebc3e]
entity PKI Service--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="93" x="1070.5" y="902.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1065.5" y="907.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1065.5" y="945.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="1086.5" y="925.7344">«service»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="1080.5" y="942.2227">PKI Service</text><!--MD5=[90fbbf7b6c870618297b0507f9a7a4e4]
entity IoTHub Gateway--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="131" x="803.5" y="99.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="798.5" y="104.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="798.5" y="142.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="61" x="838.5" y="122.7344">«service»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="813.5" y="139.2227">IoTHub Gateway</text><!--MD5=[084e4c2da341887b8d9e91d65abc0526]
entity IS API Server--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="873.5" y="902.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="868.5" y="907.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="868.5" y="945.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="886.5" y="925.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="883.5" y="942.2227">IS API Server</text><!--MD5=[4815293e3103fd40b22d8b2760126ba0]
entity KS API Server--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="693" y="902.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="688" y="907.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="688" y="945.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="708.5" y="925.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="703" y="942.2227">KS API Server</text><!--MD5=[e46db663c6807955aebb9f838b3ae64c]
entity CS API Server--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="1029.5" y="1116.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1024.5" y="1121.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="1024.5" y="1159.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="1045.5" y="1139.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="1039.5" y="1156.2227">CS API Server</text><!--MD5=[3015580521d7a46dd6257113700ed852]
entity IS MR Client--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="850.5" y="688.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="845.5" y="693.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="845.5" y="731.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="861.5" y="711.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="81" x="860.5" y="728.2227">IS MR Client</text><!--MD5=[ecef60f21877ac11267e02fd67475444]
entity CS MR Client--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="566.5" y="688.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="561.5" y="693.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="561.5" y="731.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="580.5" y="711.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="576.5" y="728.2227">CS MR Client</text><!--MD5=[6415928faf73ed48dc9621681c894071]
entity KS MR Client--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="709" y="688.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="704" y="693.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="704" y="731.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="722.5" y="711.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="719" y="728.2227">KS MR Client</text><!--MD5=[3155f9bf23155fc869faccdedd826a7d]
entity MR API Server--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="674" y="533.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="669" y="538.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="669" y="559.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="684" y="556.7344">MR API Server</text><!--MD5=[5ba7c1ccec5022ed021ea15342905256]
entity EA Runtime--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="819.5" y="293.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="814.5" y="298.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="814.5" y="319.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="79" x="829.5" y="316.7344">EA Runtime</text><!--MD5=[5b83bafd7c74b83ec51e270621bf56a2]
entity MR EA Client--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="677.5" y="293.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="672.5" y="298.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="672.5" y="319.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="687.5" y="316.7344">MR EA Client</text><!--MD5=[756676c974634b40fab49708e7753de0]
entity IS HLM Client--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="109" x="370.5" y="902.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="365.5" y="907.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="365.5" y="945.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="385.5" y="925.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="380.5" y="942.2227">IS HLM Client</text><!--MD5=[5f97b384e251fd0806a911156a614b7f]
entity KS HLM Client--><rect fill="#00FFFF" filter="url(#f1g1cejif7hzz5)" height="52.9766" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="221" y="902.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="216" y="907.1992"/><rect fill="#00FFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="216" y="945.1758"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="79" x="238.5" y="925.7344">«newclient»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="231" y="942.2227">KS HLM Client</text><!--MD5=[c924f980343bd788827f783d5a7edfc1]
entity IoTHub HLM Client--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="38.5" y="910.6992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33.5" y="915.6992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="33.5" y="937.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="48.5" y="934.2344">IoTHub HLM Client</text><!--MD5=[aa4aa3311aae7e180c9897bde274b371]
entity MR EH Client--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="107" x="513.5" y="293.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="508.5" y="298.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="508.5" y="319.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="523.5" y="316.7344">MR EH Client</text><!--MD5=[59f73ad67132c429e47a2962912cd517]
entity IoTHub EH Client--><rect fill="#FFFFFF" filter="url(#f1g1cejif7hzz5)" height="36.4883" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="342" y="293.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="337" y="298.1992"/><rect fill="#FFFFFF" height="5" style="stroke: #A80036; stroke-width: 1.5;" width="10" x="337" y="319.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="352" y="316.7344">IoTHub EH Client</text><!--MD5=[2571bb1592dc874a255a7701a0171bbf]
entity Operator--><ellipse cx="1197" cy="94.6992" fill="#FEFECE" filter="url(#f1g1cejif7hzz5)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 1.5;"/><path d="M1197,102.6992 L1197,129.6992 M1184,110.6992 L1210,110.6992 M1197,129.6992 L1184,144.6992 M1197,129.6992 L1210,144.6992 " fill="none" filter="url(#f1g1cejif7hzz5)" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="1166" y="163.7344">Operator</text><!--MD5=[ff028a7ac4eed75d9278e76cd9053439]
entity HSM--><path d="M1216,1130.1992 C1216,1120.1992 1241,1120.1992 1241,1120.1992 C1241,1120.1992 1266,1120.1992 1266,1130.1992 L1266,1155.6875 C1266,1165.6875 1241,1165.6875 1241,1165.6875 C1241,1165.6875 1216,1165.6875 1216,1155.6875 L1216,1130.1992 " fill="#FEFECE" filter="url(#f1g1cejif7hzz5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1216,1130.1992 C1216,1140.1992 1241,1140.1992 1241,1140.1992 C1241,1140.1992 1266,1140.1992 1266,1130.1992 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="1226" y="1157.7344">HSM</text><!--MD5=[11ecbcabae378fc48a88e79adafdb188]
entity KS_Config--><path d="M574,1130.1992 C574,1120.1992 619,1120.1992 619,1120.1992 C619,1120.1992 664,1120.1992 664,1130.1992 L664,1155.6875 C664,1165.6875 619,1165.6875 619,1165.6875 C619,1165.6875 574,1165.6875 574,1155.6875 L574,1130.1992 " fill="#FEFECE" filter="url(#f1g1cejif7hzz5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M574,1130.1992 C574,1140.1992 619,1140.1992 619,1140.1992 C619,1140.1992 664,1140.1992 664,1130.1992 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="584" y="1157.7344">KS_Config</text><!--MD5=[2aa0c087703c6d91446931294913eabb]
entity CS_Config--><path d="M1235.5,1242.1992 C1235.5,1232.1992 1281,1232.1992 1281,1232.1992 C1281,1232.1992 1326.5,1232.1992 1326.5,1242.1992 L1326.5,1267.6875 C1326.5,1277.6875 1281,1277.6875 1281,1277.6875 C1281,1277.6875 1235.5,1277.6875 1235.5,1267.6875 L1235.5,1242.1992 " fill="#FEFECE" filter="url(#f1g1cejif7hzz5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1235.5,1242.1992 C1235.5,1252.1992 1281,1252.1992 1281,1252.1992 C1281,1252.1992 1326.5,1252.1992 1326.5,1242.1992 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="1245.5" y="1269.7344">CS_Config</text><!--MD5=[2d8738bb92e9295d1373399849627c18]
entity IS_Config--><path d="M1305.5,1130.1992 C1305.5,1120.1992 1348,1120.1992 1348,1120.1992 C1348,1120.1992 1390.5,1120.1992 1390.5,1130.1992 L1390.5,1155.6875 C1390.5,1165.6875 1348,1165.6875 1348,1165.6875 C1348,1165.6875 1305.5,1165.6875 1305.5,1155.6875 L1305.5,1130.1992 " fill="#FEFECE" filter="url(#f1g1cejif7hzz5)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M1305.5,1130.1992 C1305.5,1140.1992 1348,1140.1992 1348,1140.1992 C1348,1140.1992 1390.5,1140.1992 1390.5,1130.1992 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="65" x="1315.5" y="1157.7344">IS_Config</text><!--MD5=[8653b4459334fbbbf517633636e5f0f4]
link Operator to DPS Gateway--><path d="M1197,166.5892 C1197,276.8592 1197,584.2092 1197,682.8192 " fill="none" id="Operator-&gt;DPS Gateway" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1197,687.9192,1201,678.9192,1197,682.9192,1193,678.9192,1197,687.9192" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[65764519f9d838083717bf16dc95b484]
link Operator to IoTHub Gateway--><path d="M1165.75,125.6992 C1090.52,125.6992 1015.3,125.6992 940.08,125.6992 " fill="none" id="Operator-&gt;IoTHub Gateway" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="934.66,125.6992,943.66,129.6992,939.66,125.6992,943.66,121.6992,934.66,125.6992" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[d63ee6e7314cd6a0bff3b3c9dd1a6e38]
link Operator to PKI Service--><path d="M1189.56,166.2192 C1171.09,266.9592 1123.78,541.7092 1112,773.1992 C1109.82,816.0192 1112.31,865.5592 1114.49,896.7592 " fill="none" id="Operator-&gt;PKI Service" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1114.86,901.9892,1118.2067,892.7264,1114.5027,897.002,1110.2272,893.298,1114.86,901.9892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c750f082465d46bb52b42d8b8f3b4813]
link Operator to HSM--><path d="M1213.77,166.2192 C1217.32,175.8792 1220.68,186.2892 1223,196.1992 C1280.82,443.1692 1275.74,511.7092 1267,765.1992 C1262.47,896.4592 1249.09,1052.9992 1243.5,1114.7492 " fill="none" id="Operator-&gt;HSM" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1243.02,1120.0792,1247.8273,1111.4833,1243.4778,1115.1002,1239.8609,1110.7508,1243.02,1120.0792" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="1272" y="614.7676">HSM tools</text><!--MD5=[b64139e04b25806d034a9609fbc498f1]
link Operator to KS_Config--><path d="M1165.97,164.5992 C1121.01,216.6392 1032.38,308.7992 935,353.1992 C863.91,385.6092 838.65,369.6092 761,378.1992 C738.18,380.7192 677.06,373.3992 658,386.1992 C414.93,549.4392 565.64,1001.3092 608.62,1115.3192 " fill="none" id="Operator-&gt;KS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="610.46,1120.1692,611.019,1110.3362,608.6919,1115.4923,603.5358,1113.1652,610.46,1120.1692" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9c6a52b0e54635debeabca1453942af9]
link Operator to CS_Config--><path d="M1228.03,133.9092 C1294.78,151.4692 1446,203.0692 1446,310.1992 C1446,310.1992 1446,310.1992 1446,1143.6992 C1446,1199.4492 1379.98,1228.6892 1331.46,1242.6392 " fill="none" id="Operator-&gt;CS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1326.52,1244.0292,1336.2638,1245.4641,1331.3362,1242.6858,1334.1144,1237.7582,1326.52,1244.0292" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[fafc128abf58ddb02bcf3db2f67a42d9]
link Operator to IS_Config--><path d="M1228.01,140.9992 C1279,166.9092 1375,226.7592 1375,310.1992 C1375,310.1992 1375,310.1992 1375,929.6992 C1375,996.8092 1361.52,1074.9192 1353.61,1114.9892 " fill="none" id="Operator-&gt;IS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1352.58,1120.1492,1358.2764,1112.1148,1353.5661,1115.2474,1350.4335,1110.5371,1352.58,1120.1492" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[f7f4374d74a0dafac0de0dcb25a2eadc]
link IS MR Client to IS API Server--><path d="M904.02,741.2692 C908.62,780.3492 917.4,854.7992 922.36,896.8292 " fill="none" id="IS MR Client-&gt;IS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="922.97,902.0392,925.8895,892.633,922.385,897.0736,917.9444,893.5691,922.97,902.0392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="910" y="786.7676">IPC</text><!--MD5=[30ae9fcea06dd066621be03fe1b356e0]
link CS MR Client to CS API Server--><path d="M615.49,741.4492 C608.04,792.7192 599.06,908.7092 655,979.1992 C746.5,1094.5092 929.37,1128.0192 1024.45,1137.7392 " fill="none" id="CS MR Client-&gt;CS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1029.47,1138.2392,1020.9016,1133.383,1024.4937,1137.753,1020.1237,1141.3451,1029.47,1138.2392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="656" y="933.7676">IPC</text><!--MD5=[1008acadb4c2978c020300657155410c]
link KS MR Client to KS API Server--><path d="M760.31,741.2692 C757.73,780.3492 752.81,854.7992 750.04,896.8292 " fill="none" id="KS MR Client-&gt;KS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="749.69,902.0392,754.2732,893.3217,750.0188,897.05,746.2905,892.7957,749.69,902.0392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="758" y="786.7676">IPC</text><!--MD5=[37e6076a4049de8edacfa18a9f5348bb]
reverse link IS API Server to IS HLM Client--><path d="M908.41,897.4792 C890.23,868.7292 858.91,827.9392 819,810.1992 C721.12,766.6992 679.35,775.5392 578,810.1992 C525.07,828.2992 476.27,872.9792 448.62,902.0092 " fill="none" id="IS API Server&lt;-IS HLM Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="911.22,901.9892,909.8568,892.2352,908.5764,897.7452,903.0664,896.4649,911.22,901.9892" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="645" y="786.7676">IPC</text><!--MD5=[071d54447f5e119d689f2347575b814f]
reverse link KS API Server to KS HLM Client--><path d="M732.8,897.5692 C716.86,868.8892 688.86,828.1392 651,810.1992 C591.15,781.8492 411.01,778.2592 353,810.1992 C317.7,829.6292 296.7,873.4692 286.26,902.0292 " fill="none" id="KS API Server&lt;-KS HLM Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="735.25,902.0692,734.4385,892.2539,732.8497,897.683,727.4206,896.0943,735.25,902.0692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="672" y="786.7676">IPC</text><!--MD5=[6804a73eee8e7028acdf854589507bfe]
link MR EH Client to MR API Server--><path d="M578.79,329.3192 C608.04,371.7492 683.84,481.7692 716.11,528.5892 " fill="none" id="MR EH Client-&gt;MR API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="719.09,532.9192,717.3031,523.2338,716.264,528.7944,710.7034,527.7554,719.09,532.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="611" y="374.7676">IPC</text><!--MD5=[989b15a203ee7fd66555711c1bdf2e5d]
link MR EA Client to MR API Server--><path d="M731,329.3192 C731,371.4992 731,480.4392 731,527.7292 " fill="none" id="MR EA Client-&gt;MR API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="731,532.9192,735,523.9192,731,527.9192,727,523.9192,731,532.9192" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="732" y="374.7676">IPC</text><!--MD5=[28ddb885fa13667552cb7de1667e3457]
link MR API Server to IS MR Client--><path d="M759.04,569.4292 C780.51,583.3292 810.2,604.1392 833,626.1992 C850.97,643.5892 868.23,665.8792 880.86,683.6092 " fill="none" id="MR API Server-&gt;IS MR Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="883.96,688.0092,882.0351,678.3503,881.0755,683.9252,875.5006,682.9656,883.96,688.0092" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[4c4b7c7619f8975f5a871590d840d99f]
link MR API Server to CS MR Client--><path d="M719.12,569.4792 C700.39,596.7392 663.74,650.0592 640.64,683.6692 " fill="none" id="MR API Server-&gt;CS MR Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="637.61,688.0792,646.0087,682.9351,640.4457,683.9611,639.4197,678.3981,637.61,688.0792" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[51c6f3a2b7f646dbcbed439c36e2ccd8]
link MR API Server to KS MR Client--><path d="M734.32,569.4792 C739.51,596.5192 749.62,649.1892 756.08,682.8492 " fill="none" id="MR API Server-&gt;KS MR Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="757.08,688.0792,759.3125,678.4867,756.1379,683.1688,751.4558,679.9941,757.08,688.0792" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[e720ecd5333c3e6747c8d16060e24f97]
link IS API Server to CS API Server--><path d="M933.68,955.3192 C938.78,970.2392 946.32,989.0392 956,1004.1992 C982.72,1046.0492 1023.06,1086.5792 1051.51,1112.6592 " fill="none" id="IS API Server-&gt;CS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1055.27,1116.0892,1051.329,1107.0632,1051.5807,1112.7145,1045.9294,1112.9662,1055.27,1116.0892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[be9537374aefee3a52829d99303fa4e2]
link KS API Server to HSM--><path d="M796.52,955.2692 C815.01,964.0592 836.56,973.1992 857,979.1992 C930.69,1000.8492 951.6,996.2592 1028,1004.1992 C1042.28,1005.6792 1144.6,1004.9592 1157,1012.1992 C1196.32,1035.1692 1220.45,1084.6892 1232.23,1115.4092 " fill="none" id="KS API Server-&gt;HSM" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1234.02,1120.1692,1234.6052,1110.3378,1232.2644,1115.4876,1227.1146,1113.1467,1234.02,1120.1692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1029" y="1000.7676">aziot-keys</text><!--MD5=[0ec0b1c00808d2d43efbd3f658751262]
link IS API Server to IS_Config--><path d="M978.73,954.3392 C1001.4,963.8092 1028.5,973.6692 1054,979.1992 C1113.61,992.1292 1130.79,977.4492 1191,987.1992 C1233.25,994.0392 1250.91,985.0492 1284,1012.1992 C1316.25,1038.6692 1333.62,1085.4292 1341.82,1114.9292 " fill="none" id="IS API Server-&gt;IS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1343.15,1119.8692,1344.6459,1110.1346,1341.8368,1115.0447,1336.9267,1112.2357,1343.15,1119.8692" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[34ec41cfc1c7b579f14b0532db03187f]
link CS API Server to CS_Config--><path d="M1130.46,1169.2092 C1162.79,1187.3592 1205.97,1211.5892 1237.78,1229.4492 " fill="none" id="CS API Server-&gt;CS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1242.39,1232.0292,1236.4958,1224.1388,1238.0287,1229.584,1232.5835,1231.1169,1242.39,1232.0292" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[1fd5ab5a4360626f892f5df4f4d73889]
link KS API Server to KS_Config--><path d="M732.44,955.2692 C707.68,995.9692 659.57,1075.0292 634.71,1115.8792 " fill="none" id="KS API Server-&gt;KS_Config" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="632.09,1120.1892,640.1863,1114.5812,634.6897,1115.9182,633.3527,1110.4216,632.09,1120.1892" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6437316005e372b013bcebfc39248628]
reverse link IoTHub Gateway to IS API Server--><path d="M896.34,156.4092 C910.65,173.8992 926.85,197.2492 935,221.1992 C1013.02,450.5092 998.55,524.9092 968,765.1992 C961.73,814.4892 945.18,870.1992 934.83,901.9192 " fill="none" id="IoTHub Gateway&lt;-IS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="893.13,152.5392,895.8153,162.0149,896.3295,156.3815,901.963,156.8957,893.13,152.5392" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="993" y="556.2676">HTTPS</text><!--MD5=[f062dee797d7b0105199cffe6fb14117]
link IS API Server to KS API Server--><path d="M873.43,928.6992 C853,928.6992 829.49,928.6992 808.37,928.6992 " fill="none" id="IS API Server-&gt;KS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="803.34,928.6992,812.34,932.6992,808.34,928.6992,812.34,924.6992,803.34,928.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="828.25" y="922.2676">IPC</text><!--MD5=[e067edb8b6787edeb92255ee41180f85]
reverse link PKI Service to CS API Server--><path d="M1112.39,960.2192 C1106.06,1002.1492 1094.79,1076.8292 1088.87,1116.0392 " fill="none" id="PKI Service&lt;-CS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1113.14,955.2692,1107.8234,963.5598,1112.3829,960.2116,1115.7312,964.7711,1113.14,955.2692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="1108" y="1000.7676">HTTPS (EST)</text><!--MD5=[1ba61940d09e9bcc638ddaa746e5f6f8]
link IoTHub Gateway to IoTHub EH Client--><path d="M798.14,132.9692 C719.7,142.4692 591.72,165.7192 496,221.1992 C466.5,238.2992 440.52,268.4092 425.04,288.8192 " fill="none" id="IoTHub Gateway-IoTHub EH Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="421.9,293.0192,430.489,288.1995,424.8908,289.0124,424.078,283.4142,421.9,293.0192" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="803.23,132.3692,793.8238,129.4498,798.2643,132.9543,794.7598,137.3948,803.23,132.3692" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="543" y="209.7676">AMQP (EH Module)</text><!--MD5=[cbcbca9f985bb6aa0d9e9d43e5dd7433]
link IoTHub Gateway to IoTHub HLM Client--><path d="M798.32,131.0692 C626.32,143.6192 200,187.1392 200,310.1992 C200,310.1992 200,310.1992 200,715.6992 C200,790.3692 152.85,869.3092 127.58,906.2692 " fill="none" id="IoTHub Gateway-IoTHub HLM Client" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="124.61,910.5592,133.017,905.4287,127.4523,906.4457,126.4354,900.881,124.61,910.5592" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="803.33,130.6992,794.0672,127.3525,798.3428,131.0565,794.6388,135.332,803.33,130.6992" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="201" y="556.2676">AMQP (HL Module)</text><!--MD5=[847749b71113e909cc8a19318a9f9a5c]
reverse link DPS Gateway to IS API Server--><path d="M1140.59,743.6992 C1113.34,758.3392 1080.81,777.5092 1054,798.1992 C1012.83,829.9692 971.72,874.3792 947.59,902.0692 " fill="none" id="DPS Gateway&lt;-IS API Server" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1145.27,741.2092,1135.4478,741.9333,1140.8626,743.5703,1139.2256,748.9851,1145.27,741.2092" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="1088" y="786.7676">HTTPS</text><!--MD5=[a20d16dcaadd67f259e89e744d6fba35]
reverse link IoTHub Gateway to EA Runtime--><path d="M869,157.2892 C869,196.2092 869,262.1092 869,293.1092 " fill="none" id="IoTHub Gateway&lt;-EA Runtime" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="869,152.2092,865,161.2092,869,157.2092,873,161.2092,869,152.2092" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="870" y="209.7676">HTTPS</text><!--MD5=[6f15b76719f352d3bc99a802728f5c16]
@startuml
title Data Flow - new architecture

actor Operator
cloud "DPS Service" {
    [DPS Gateway] <<service>>
}

cloud "PKI" {
    [PKI Service] <<service>>
}

cloud "IoT Hub Service" {
    [IoTHub Gateway] <<service>>
}

node "Identity Service" <<new>> {
    [IS API Server] <<newclient>>
}

node "Key Service" <<new>> {
    [KS API Server] <<newclient>>
    [KS API Server] <<newclient>>
}

node "Certificate Service" <<new>> {
    [CS API Server] <<newclient>>
}

node "Edge Module Runtime" <<modified>> {
    folder "MR Legacy Service" {
        [MR API Server]
    }
    [IS MR Client] <<newclient>>
    [CS MR Client] <<newclient>>
    [KS MR Client] <<newclient>>
}
node "Edge Agent" {
    [EA Runtime]
    [MR EA Client]
}
node "Host-level module" {
    [IS HLM Client] <<newclient>>
    [KS HLM Client] <<newclient>>
    [IoTHub HLM Client]
}
node "Edge Hub" {
    [MR EH Client]
    [IoTHub EH Client]
}

database "HSM"
database "KS_Config"
database "CS_Config"
database "IS_Config"


Operator -right-> [DPS Gateway]
Operator -right-> [IoTHub Gateway]
Operator -right-> [PKI Service]
Operator -right-> HSM: HSM tools
Operator -right-> KS_Config
Operator -right-> CS_Config
Operator -right-> IS_Config

[IS MR Client] -down-> [IS API Server] : IPC
[CS MR Client] -down-> [CS API Server] : IPC
[KS MR Client] -down-> [KS API Server] : IPC
[IS HLM Client] -left-> [IS API Server] : IPC
[KS HLM Client] -left-> [KS API Server] : IPC
[MR EH Client] - -> [MR API Server] : IPC
[MR EA Client] - -> [MR API Server] : IPC

[MR API Server] -down-> [IS MR Client]
[MR API Server] -down-> [CS MR Client]
[MR API Server] -down-> [KS MR Client]
[IS API Server] -down-> [CS API Server]
[KS API Server] -down-> HSM : aziot-keys
[IS API Server] - -> IS_Config
[CS API Server] - -> CS_Config
[KS API Server] - -> KS_Config

[IS API Server] -up-> [IoTHub Gateway] : HTTPS
[IS API Server] -right-> [KS API Server] : IPC
[CS API Server] -up-> [PKI Service] : HTTPS (EST)

[IoTHub EH Client] <-up-> [IoTHub Gateway] : AMQP (EH Module)
[IoTHub HLM Client] <-up-> [IoTHub Gateway] : AMQP (HL Module)
[IS API Server] -up-> [DPS Gateway] : HTTPS

[EA Runtime] -up-> [IoTHub Gateway] : HTTPS

skinparam node {
	backgroundColor<<new>> Magenta
	backgroundColor<<modified>> Yellow
}

skinparam component {
    backgroundColor White
    backgroundColor<<newclient>> Cyan
    backgroundColor<<modified>> Yellow
    backgroundColor<<service>> White
}

@enduml

PlantUML version 1.2020.10(Sun May 17 02:35:57 PDT 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 13.0.1+9
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>